<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Secret Santa</title>

<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no">

<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
<meta http-equiv="Pragma" content="no-cache" />
<meta http-equiv="Expires" content="0" />

<link rel="manifest" href="manifest.json">
<link rel="stylesheet" href="style.css">
<link rel="icon" href="icons/icon-192.png" type="image/png">
<link rel="apple-touch-icon" sizes="192x192" href="icons/icon-192.png">
<link rel="apple-touch-icon" sizes="512x512" href="icons/icon-512.png">
</head>
<body>

<div id="loginBox" style="display:none;">
<h1>ğŸ… Secret Santa ğŸ</h1>
<p>Enter your email and login code:</p>
<input id="email" type="email" placeholder="example@email.com">
<input id="code" type="text" placeholder="Login Code">
<button id = "loginBtn" onclick="handleLogin()">Login</button>
<div id="loader"><div class="spinner"></div><p id = "loaderText">Logging you in...</p></div>
</div>

<div id="revealScreen" style="display:none;">
  <div class="emoji">ğŸ‰ Surprise! ğŸ‰</div>
  <div>Your Secret Santa assignment is:</div>
  <div id="assignedNameReveal"></div>
  <button id="continueButton">Continue</button>
</div>

<div id="dashboard" class="dashboard-container">
  <button id="logoutBtn" onclick="handleLogout()">X</button>
  <h2>Welcome, <span id="userName"></span>!</h2>
  <h3>You are buying a gift for <span id="assignedName"></span>.</h3>

  <!-- My Wishlist -->
  <div class="card-section">
    <h3>Your Wishlist</h3>
    <div class="wishlist-container">
      <textarea id="myWishlist" rows="3" placeholder="Write your wishlist here..."></textarea>
      <button id = "myWishlistBtn" onclick="saveWishlist()">Save</button>
    </div>
  </div>

  <!-- Assigned Person's Wishlist -->
  <div class="card-section">
    <h3><span id="assignedNameWishlist"></span>'s Wishlist:</h3>
    <textarea id="assignedWishlist" class="wishlist-display" readonly></textarea>
  </div>

  <!-- Chat with Assigned Person -->
  <div class="card-section">
    <h3>Chat with <span id="assignedNameChat"></span></h3>
    <div id="chatAssigned" class="chatBox"></div>
    <div class="chat-input-container">
      <textarea id="chatAssignedInput" class = "chat-textarea"
              placeholder="Type a message..."
              oninput="autoResize(this)"
              onblur="resetHeight(this)"
             onkeydown="if(event.key==='Enter' && !event.shiftKey){event.preventDefault();sendChat('assigned')}"></textarea>
      <button onclick="sendChat('assigned')">></button>
    </div>
  </div>

  <!-- Chat with Secret Santa -->
  <div class="card-section">
    <h3>Chat with your Secret Santa</h3>
    <div id="chatSanta" class="chatBox"></div>
    <div class="chat-input-container">
      <textarea id="chatSantaInput" class = "chat-textarea"
              placeholder="Type a message..."
              oninput="autoResize(this)"
              onblur="resetHeight(this)"
             onkeydown="if(event.key==='Enter' && !event.shiftKey){event.preventDefault();sendChat('santa')}"></textarea>
      <button onclick="sendChat('santa')">></button>
    </div>
  </div>
</div>

<script type="module" src="app.js"></script>

<script>
if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    navigator.serviceWorker.register('./service-worker.js')
      .then(reg => console.log('Service worker registered.', reg))
      .catch(err => console.error('Service worker registration failed:', err));
  });
}
</script>

</body>
</html>
